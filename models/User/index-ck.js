function validUsername(a){return a.length>7}function validEmail(a){return a.length>0}function validPass(a){return a.length>5}var mongoose=require("mongoose"),mongohq_url=process.env.MONGOHQ_URL||"mongodb://heroku:9d7d88ec83810d172f98065cb9398617@flame.mongohq.com:27078/app4216978",db=mongoose.connect(mongohq_url),Schema=db.Schema,User=new Object,UserSchema=new Schema({username:{type:String,unique:!0,"default":"",required:!0,validate:[validUsername,"Nickname is not valid. Must be at least 8 characters"]},email:{type:String,unique:!0,required:!0,validate:[validEmail,"E-mail is not valid"]},password:{type:String,required:!0,validate:[validPass,"Password is not valid. Must be at least 6 characters"]},date_added:{type:Date,"default":Date.now},img:{data:Buffer,contentType:String},fname:String,lname:String,clearance:{type:String,"default":"user",required:!0}});mongoose.model("UserModel",UserSchema);var User=mongoose.model("UserModel"),UserModel=function(){};UserModel.prototype.add=function(a){var b=new User;b.username=this.username;b.email=this.email;b.password=this.password;b.img=this.img;b.fname=this.fname;b.lname=this.lname;b.clearance=this.clearance||"user";b.save(function(b,c){a(b)})};UserModel.prototype.get=function(a,b,c,d){if(a!==undefined)User.findById(a,function(a,b){if(a===undefined)throw new Error("Failed to find user: "+a);d(b)});else if(b!==undefined)User.findOne({username:b},function(a,b){if(a===undefined)throw new Error("Failed to find user: "+a);d(b)});else{if(c===undefined)throw new Error("Cannot find User without reference.");User.findOne({email:c},function(a,b){if(a===undefined)throw new Error("Failed to find user: "+a);d(b)})}};UserModel.prototype.login=function(a){User.findOne({$or:[{username:this.username},{email:this.username}],password:this.password},function(b,c){if(b===undefined)throw new Error("Failed to find user: "+b);a(c)})};UserModel.prototype.getAll=function(a){User.find({},function(b,c){if(b===undefined)throw new Error("Failed to get users: "+b);a(c)})};UserModel.prototype.create=function(a){var b={_id:this._id},c={fname:this.fname,lname:this.lname,email:this.email};User.update(b,{$set:c},a)};UserModel.prototype.deleteById=function(a){var b={_id:this._id};User.remove(b,a)};module.exports=UserModel;